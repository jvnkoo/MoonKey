{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"User Documentation","text":""},{"location":"#overview","title":"Overview","text":"<p>MoonKey provides automation capabilities through Lua scripting.  Scripts execute in a managed environment with hot-reload functionality.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<ol> <li>Create a <code>scripts</code> folder in the same directory as the executable</li> <li>Create <code>main.lua</code> inside that folder</li> <li>Write your automation script using the API below</li> <li>Run the executable - it will automatically reload when you save your script</li> </ol>"},{"location":"#core-functions","title":"Core Functions","text":"Function Description Example log Prints a message to console <code>log(\"System ready\")</code> bind Registers a global hotkey <code>bind(MOD.ALT, KEY.F1, function() end, \"Notepad\")</code> send Simulates a key press <code>send(KEY.ENTER)</code> focus Brings window to foreground <code>focus(\"Notepad\")</code> write Types text <code>write(\"Hello, World!\")</code> wait Pauses script (seconds) <code>wait(1.5)</code> sleep Pauses script (milliseconds) <code>sleep(500)</code> mouse_move Moves cursor to X, Y coordinates <code>mouse_move(1920, 1080)</code> mouse_click Clicks mouse button <code>mouse_click(0)</code> mouse_pos Returns current mouse position <code>local p = mouse_pos()</code> set_interval Sets a repeating timer <code>set_interval(1000, function() log(\"Tick\") end, \"Notepad\")</code> <p>Note</p> <p>Window title in the last parameter is optional</p>"},{"location":"#example-script","title":"Example Script","text":"<pre><code>-- Simple automation example\nbind(MOD.ALT, KEY.T, function()\n    focus(\"Notepad\")\n    write(\"Automation complete!\")\n    send(KEY.ENTER)\nend)\n\n-- Wait and click\nbind(MOD.CTRL + MOD.SHIFT, KEY.M, function()\n    mouse_move(100, 100)\n    wait(0.5)\n    mouse_click(0)\nend)\n</code></pre>"},{"location":"#key-reference","title":"Key Reference","text":"<p>See Keys &amp; Modifiers Reference for complete list of available keys and modifiers.</p>"},{"location":"api-reference/","title":"API Reference","text":"<p>Complete reference for all functions available in MoonKey Lua scripts.</p>"},{"location":"api-reference/#logging","title":"Logging","text":""},{"location":"api-reference/#logmessage","title":"log(message)","text":"<p>Prints a message to console.</p> <p>Parameters:</p> <ul> <li><code>message</code> (string) - Text to print</li> </ul> <p>Example:</p> <pre><code>log(\"System ready\")\n</code></pre>"},{"location":"api-reference/#hotkey-management","title":"Hotkey Management","text":""},{"location":"api-reference/#bindmodifiers-key-callback-windowtitle","title":"bind(modifiers, key, callback, [windowTitle])","text":"<p>Registers a global hotkey.</p> <p>Parameters:</p> <ul> <li><code>modifiers</code> (number) - Modifier keys (use <code>MOD</code> constants)</li> <li><code>key</code> (number) - Virtual key code (use <code>KEY</code> constants)</li> <li><code>callback</code> (function) - Function to execute when hotkey is pressed</li> <li><code>windowTitle</code> (string, optional) - Only trigger when this window is active</li> </ul> <p>Examples:</p> <pre><code>bind(MOD.ALT, KEY.F1, function() end)           -- Alt + F1\nbind(MOD.CTRL + MOD.SHIFT, KEY.T, function() end) -- Ctrl + Shift + T\nbind(MOD.WIN, KEY.R, function() end)             -- Windows + R\n</code></pre>"},{"location":"api-reference/#input-simulation","title":"Input Simulation","text":""},{"location":"api-reference/#sendkey","title":"send(key)","text":"<p>Simulates a key press.</p> <p>Parameters:</p> <ul> <li><code>key</code> (number) - Virtual key code (use <code>KEY</code> constants)</li> </ul> <p>Example:</p> <pre><code>send(KEY.ENTER)\n</code></pre> <p>Notes:</p> <ul> <li>Simulates pressing and immediately releasing a key</li> <li>Equivalent to a quick tap on the keyboard</li> <li>Uses Windows SendInput() with KEYDOWN and KEYUP events</li> <li>For modifier keys, consider holding them with multiple calls</li> </ul>"},{"location":"api-reference/#writetext","title":"write(text)","text":"<p>Types text as if from keyboard.</p> <p>Parameters:</p> <ul> <li><code>text</code> (string) - String to type</li> </ul> <p>Example:</p> <pre><code>write(\"Hello, World!\")\n</code></pre> <p>Notes:</p> <ul> <li>Simulates typing complete strings with proper shift key handling for uppercase and special characters</li> <li>Includes small delays between keystrokes for reliability with some applications</li> <li>Handles shift states for characters like @, !, %, etc.</li> <li>Includes 15ms delay between keystrokes</li> <li>Not suitable for extremely fast typing simulation</li> </ul>"},{"location":"api-reference/#window-management","title":"Window Management","text":""},{"location":"api-reference/#focuswindowtitle","title":"focus(windowTitle)","text":"<p>Brings window to foreground and gives it focus.</p> <p>Parameters:</p> <ul> <li><code>windowTitle</code> (string) - Window title or class name to find</li> </ul> <p>Example:</p> <pre><code>focus(\"Notepad\")\n</code></pre> <p>Notes:</p> <ul> <li>Searches for a window with the specified title or class name and attempts to bring it to the foreground</li> <li>Tries two search methods:<ol> <li>By window title (caption)</li> <li>By window class name</li> </ol> </li> <li>Uses FindWindow() with NULL class name, then with NULL window name</li> <li>Shows window with SW_RESTORE if minimized</li> <li>May fail due to Windows security restrictions on foreground changes</li> </ul> <p>Warning</p> <ul> <li>Some applications block foreground window changes for security</li> <li>UWP/Store apps may not be accessible with this method</li> </ul>"},{"location":"api-reference/#timing-functions","title":"Timing Functions","text":""},{"location":"api-reference/#waitseconds","title":"wait(seconds)","text":"<p>Pauses script execution (seconds).</p> <p>Parameters:</p> <ul> <li><code>seconds</code> (number) - Time to wait in seconds (can be fractional)</li> </ul> <p>Example:</p> <pre><code>wait(1.5)\n</code></pre>"},{"location":"api-reference/#sleepmilliseconds","title":"sleep(milliseconds)","text":"<p>Pauses script execution (milliseconds).</p> <p>Parameters:</p> <ul> <li><code>milliseconds</code> (number) - Time to wait in milliseconds</li> </ul> <p>Example:</p> <pre><code>sleep(500)\n</code></pre>"},{"location":"api-reference/#set_intervalms-callback-targetwindow","title":"set_interval(ms, callback, [targetWindow])","text":"<p>Sets a repeating timer.</p> <p>Parameters:</p> <ul> <li><code>ms</code> (number) - Interval in milliseconds between callback executions</li> <li><code>callback</code> (function) - Lua function to call when timer ticks</li> <li><code>targetWindow</code> (string, optional) - Optional window title for context-sensitive timers</li> </ul> <p>Example:</p> <pre><code>set_interval(1000, function() \n    log(\"Tick\") \nend, \"Notepad\")\n</code></pre> <p>Notes:</p> <ul> <li>If targetWindow is specified, the callback will only execute when that window is active</li> <li>If empty, the timer will execute regardless of active window</li> </ul>"},{"location":"api-reference/#mouse-control","title":"Mouse Control","text":""},{"location":"api-reference/#mouse_movex-y","title":"mouse_move(x, y)","text":"<p>Moves cursor to X, Y coordinates.</p> <p>Parameters:</p> <ul> <li><code>x</code> (number) - X coordinate (0 = left edge, screen width = right edge)</li> <li><code>y</code> (number) - Y coordinate (0 = top edge, screen height = bottom edge)</li> </ul> <p>Example:</p> <pre><code>mouse_move(1920, 1080)\n</code></pre> <p>Notes:</p> <ul> <li>Moves cursor instantly to specified position using absolute coordinates</li> <li>Coordinates are transformed to Windows' virtual screen space (0-65535)</li> <li>Uses MOUSEEVENTF_MOVE | MOUSEEVENTF_ABSOLUTE flags</li> <li>Coordinates outside screen bounds are clamped by Windows</li> </ul>"},{"location":"api-reference/#mouse_clickbutton","title":"mouse_click(button)","text":"<p>Clicks mouse button.</p> <p>Parameters:</p> <ul> <li><code>button</code> (number) - Button to click<ul> <li><code>0</code> = left</li> <li><code>1</code> = right</li> <li><code>2</code> = middle</li> </ul> </li> </ul> <p>Example:</p> <pre><code>mouse_click(0)  -- Left click\nmouse_click(1)  -- Right click\nmouse_click(2)  -- Middle click\n</code></pre> <p>Notes:</p> <ul> <li>Simulates pressing and immediately releasing the specified mouse button</li> <li>Includes both down and up events for complete click simulation</li> </ul>"},{"location":"api-reference/#mouse_pos","title":"mouse_pos()","text":"<p>Returns current mouse position.</p> <p>Returns:</p> <ul> <li>Lua table with <code>{x = number, y = number}</code></li> </ul> <p>Example:</p> <pre><code>local p = mouse_pos()\n</code></pre> <p>Notes:</p> <ul> <li>Returns the current cursor position in screen coordinates</li> <li>Position is relative to the primary monitor</li> </ul>"},{"location":"keys-reference/","title":"Key &amp; Modifier Reference","text":""},{"location":"keys-reference/#modifiers-mod","title":"Modifiers (MOD)","text":"<p>Available in Lua as <code>MOD</code>. Used as the first argument in <code>bind()</code>. Modifiers can be combined using <code>+</code> operator.</p> Constant Value Description <code>MOD.NONE</code> 0 No modifier <code>MOD.ALT</code> MOD_ALT Alt key <code>MOD.CTRL</code> MOD_CONTROL Control key <code>MOD.SHIFT</code> MOD_SHIFT Shift key <code>MOD.WIN</code> MOD_WIN Windows key <code>MOD.NOREPEAT</code> 0x4000 Prevents repeated hotkey triggers"},{"location":"keys-reference/#usage-examples","title":"Usage Examples:","text":"<pre><code>bind(MOD.ALT, KEY.F1, function() end)           -- Alt + F1\nbind(MOD.CTRL + MOD.SHIFT, KEY.T, function() end) -- Ctrl + Shift + T\nbind(MOD.WIN, KEY.R, function() end)             -- Windows + R\n</code></pre>"},{"location":"keys-reference/#virtual-keys-key","title":"Virtual Keys (KEY)","text":"<p>Available in Lua as <code>KEY</code>. Used in <code>send()</code> and as the second argument in <code>bind()</code>.</p>"},{"location":"keys-reference/#letters-and-numbers","title":"Letters and Numbers","text":"<ul> <li>Letters: <code>KEY.A</code> through <code>KEY.Z</code></li> <li>Numbers: <code>KEY.N0</code> through <code>KEY.N9</code> (top row)</li> <li>Numpad: <code>KEY.NUM0</code> through <code>KEY.NUM9</code></li> </ul>"},{"location":"keys-reference/#function-keys","title":"Function Keys","text":"<ul> <li><code>KEY.F1</code> through <code>KEY.F24</code></li> </ul>"},{"location":"keys-reference/#navigation-keys","title":"Navigation Keys","text":"Key Description <code>KEY.UP</code>, <code>KEY.DOWN</code> Arrow keys <code>KEY.LEFT</code>, <code>KEY.RIGHT</code> Arrow keys <code>KEY.HOME</code>, <code>KEY.END</code> Home/End <code>KEY.PAGEUP</code>, <code>KEY.PAGEDOWN</code> Page Up/Down"},{"location":"keys-reference/#special-keys","title":"Special Keys","text":"Key Description <code>KEY.ENTER</code>, <code>KEY.SPACE</code> Enter and Space <code>KEY.ESCAPE</code>, <code>KEY.TAB</code> Escape and Tab <code>KEY.BACKSPACE</code>, <code>KEY.DELETE</code> Backspace and Delete <code>KEY.INSERT</code> Insert key"},{"location":"keys-reference/#mouse-buttons","title":"Mouse Buttons","text":"Key Description <code>KEY.LBUTTON</code> Left mouse button <code>KEY.RBUTTON</code> Right mouse button <code>KEY.MBUTTON</code> Middle mouse button"},{"location":"keys-reference/#modifier-keys-individual","title":"Modifier Keys (Individual)","text":"Key Description <code>KEY.LSHIFT</code>, <code>KEY.RSHIFT</code> Left/Right Shift <code>KEY.LCTRL</code>, <code>KEY.RCTRL</code> Left/Right Control <code>KEY.LALT</code>, <code>KEY.RALT</code> Left/Right Alt <code>KEY.LWIN</code>, <code>KEY.RWIN</code> Left/Right Windows"},{"location":"keys-reference/#numpad-operations","title":"Numpad Operations","text":"Key Description <code>KEY.MULTIPLY</code>, <code>KEY.DIVIDE</code> * and / <code>KEY.ADD</code>, <code>KEY.SUBTRACT</code> + and - <code>KEY.DECIMAL</code> Decimal point"},{"location":"keys-reference/#lock-keys","title":"Lock Keys","text":"Key Description <code>KEY.CAPSLOCK</code> Caps Lock <code>KEY.NUMLOCK</code> Num Lock <code>KEY.SCROLLLOCK</code> Scroll Lock"}]}